<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文本檢視器</title>

    <style>
        .link {
            cursor: pointer;
            color: #5888dd;
        }

        .link:hover {
            text-decoration: underline;
        }

        .gold {
            color: #ffd700;
        }

        .light {
            box-shadow: 0 0 10px 2px rgba(0, 0, 0, 0.5);
        }
    </style>

</head>

<body>
    <div id="main"></div>
    <br>
    <div id="passage">（passage）</div>
    <br>
    <div id="show"><button>返回</button></div>

    <script>
        // 我的功能是要使用者點擊link之後，會變更文字
        // 預設的文字會是第一個變更點
        // 但文字裡也會有變更
        // 感覺要寫一個變更的fn

        // eventscourtyard
        // bullyeventstreet
        // schoolbully

        var initCheck = false;

        let mainContent = [
            {
                h2: '告白',
                h3: '',
                event: [
                    '操場',
                    '小巷',
                    '噴水池'
                ],
                id: [
                    'whitneyConfessCourtyard',
                    'whitneyConfessStreet',
                    'whitneyConfessPark',
                ]
            }
        ]

        function main() {
            let Main = '';
            for (i = 0; i < mainContent.length; i++) {
                let content = mainContent[i];

                // 插入標題
                Main += `<h2>${content.h2}</h2>`;
                Main += `<h3>${content.h3}</h3>`;

                // 插入活動連結
                for (n = 0; n < content.event.length; n++) {
                    let linkId = content.id[n];
                    Main += `<span id="${linkId}" class="link">${content.event[n]}</span>`;

                    // 連結插入分隔號，但最後一個不要插入
                    if (n !== (content.event.length - 1)) {
                        Main += `｜`;
                    }

                    // 更新首頁內容
                    document.getElementById('main').innerHTML = Main;
                }
            }
        }

        // 初始化
        main();

        let T = {
            red: '<span class="red">壓力</span>',
        }

        // let passage = {
        //     whitneyConfessCourtyard:
        //         `<p>你在${V("運動")}，</p><p>你${V("好感")}的人跟你告白，</p><p>你${V("態度")}的回復。</p>`,
        // }
        // ${V("好感", 2)}

        // 提取所有的 condition
        // const conditions = whitneyConfessCourtyard.map(item => item.condition);
        // 找到 condition 為 "運動" 的對象
        // const sportCondition = whitneyConfessCourtyard.find(item => item.condition === "運動");

       
        let passage = {
            whitneyConfessCourtyard: [
                {
                    content: () => `<p>你在${V("運動")}，</p><p>你${V("好感")}的人跟你告白，</p><p>你${V("態度")}的回復。</p>`,
                },
                {
                    type: "運動",
                    variants: () => [
                        {
                            link: "跑步",
                            text: ["跑100米"],
                        },
                        {
                            link: "打籃球",
                            text: ["丟籃板球"],
                        }
                    ]
                },
                {
                    type: "好感",
                    variants: () => [
                        {
                            link: "高好感",
                            text: ['喜歡很久', `你交到${V("LI性別")}朋友了`],
                        },
                        {
                            link: "低好感",
                            text: ["討厭"],
                        }
                    ]
                },
                {
                    type: "態度",
                    variants: () => [
                        {
                            link: "溫順",
                            text: ["溫柔"],
                        },
                        {
                            link: "中立",
                            text: ["急切"],
                        }
                        ,
                        {
                            link: "抗拒",
                            text: ["自信"],
                        }
                    ]
                },
                {
                    type: "LI性別",
                    variants: () => [
                        {
                            link: "男LI",
                            text: ["男"],
                        },
                        {
                            link: "女LI",
                            text: ["女"],
                        }
                    ]
                },
            ]
        }
        
        function V(type, text) {
            if (initCheck == false) {
                console.log(`未初始化`)
                return ``;
            } else {
                console.log(`已初始化`)
                let vObj = passage.whitneyConfessCourtyard.find(item => item.type == type);
                let obj = vObj.variants();
                return obj[1].text; 
            }
        }

        function test(){

            initCheck = true;
            document.getElementById('diff').innerHTML = passage.whitneyConfessCourtyard[0].content();
            
        }

        test()

        
            

        // console.log(mainLink[0].link); //測試json用

        // 首頁
        // function he(){
        //     return "girl";
        // }



        // // 首頁點擊事件
        // for (i = 0; i < mainLink.length; i++) {
        //     for (n = 0; n < mainLink[i].link.length; n++) {
        //         let linkId = mainLink[i].id[n];
        //         document.getElementById(linkId).onclick = function () {
        //             mainHide();
        //             textChange(linkId);
        //         };

        //     }
        // }


        // // 差分點擊事件
        // function diffClick(item) {
        //     for (d = 0; d < diff[`${item}`].length; d++) {
        //         // console.log(diff[`${linkId}`][d]);
        //         for (a = 0; a < diff[`${item}`][d].length; a++) {
        //             // console.log(linkId + d + '_' + a);
        //             document.getElementById(`${item}Diff_${d}_${a}`).onclick = function () {
        //                 // console.log('點擊事件的 ID:', this.id);
        //                 textChange(item, this.id);
        //             };
        //         }
        //     }
        // }

        

        // // 顯示首頁
        // function mainShow() {
        //     mainId.style.display = 'block';
        // }
        // // 隱藏首頁
        // function mainHide() {
        //     mainId.style.display = 'none';
        // }
        // // 顯示差分
        // function diffShow() {
        //     diffId.style.display = 'block';
        // }
        // // 隱藏差分
        // function diffHide() {
        //     diffId.style.display = 'none';
        // }
        // // 顯示文本
        // function textShow() {
        //     textId.style.display = 'block';
        // }
        // // 隱藏文本
        // function textHide() {
        //     textId.style.display = 'none';
        // }
        // // 顯示選項
        // function optsShow() {
        //     optsId.style.display = 'block';
        // }
        // // 隱藏選項
        // function optsHide() {
        //     optsId.style.display = 'none';
        // }

        // // 構建首頁
        // function mainChange() {
        //     mainId.innerHTML = Main;
        // }

        // // 宣告差分參數物件
        // let T = {};


        
        // // 改變文本
        // function textChange(item, itemId) {
        //     // console.log(item, itemId);
        //     let DI = diff[`${item}`];
        //     let typeCheck = '';

        //     // 差分物件參數預設為0
        //     for (let i = 0; i < DI.length; i++) {
        //         T[`${i}`] = 0;
        //     }

        //     // 使用正則表達式匹配並提取數字
        //     if (itemId !== undefined) {
        //         const num = itemId.match(/_(\d+)_(\d+)/);
        //         if (num) {
        //             // num[1] 匹配第一個數字，num[2] 匹配第二個數字
        //             let type = parseInt(num[1], 10);
        //             T[`${type}`] = parseInt(num[2], 10);
        //             // console.log(type);
        //             // console.log(T);
        //         }
        //     }

        //     let text = {
        //         whitneyConfessCourtyard:
        //             `<p>你在${DI[0][T[0]][1]}，</p><p>你${DI[1][T[1]][1]}的人跟你告白，</p><p>你${DI[2][T[2]][1]}的回復。</p>${DI[1][T[1]][2]}`,
        //         whitneyConfessStreet:
        //             `<p>你在巷口</p><p>你喜歡的人跟你表白</p><p><span class="gold">你交到女朋友了！</span></p>`,
        //         whitneyConfessPark:
        //             `<p>你在公園</p><p>你喜歡的人跟你表達心意</p><p><span class="gold">你交到男女朋友了！</span></p>`,
        //     }

        //     mainHide();
        //     diffShow();
        //     textShow();
        //     diffId.innerHTML = Diff[item];
        //     textId.innerHTML = text[item];
        //     diffClick(item)

        //     // 讓變更的文字發光
        //     if (itemId !== undefined) {
        //         const num = itemId.match(/_(\d+)_(\d+)/);
        //         if (num) {
        //             // console.log(`${item}Text_${num[1]}_${num[2]}`);
        //             let lightText = document.getElementsByClassName(`${item}Text_${num[1]}_${num[2]}`);
        //             // 遍歷class屬性
        //             Array.from(lightText).forEach(function (element) {
        //                 element.classList.add('light');
        //                 // 指定時間後去掉發光效果
        //                 setTimeout(function () {
        //                     element.classList.remove("light");
        //                 }, 1000);
        //             });
        //         }
        //     }
        // }

        // // 返回主頁的按鈕
        // document.getElementById('show').onclick = function () {
        //     mainShow();
        //     diffHide();
        //     textHide();
        // };
    </script>

</body>

</html>